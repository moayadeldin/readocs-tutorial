

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Using DeepTune for Evaluation &mdash; DeepTune 0.1 documentation</title>
      <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="../../_static/css/theme.css?v=e59714d7" />

  
      <script src="../../_static/jquery.js?v=5d32c60e"></script>
      <script src="../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../../_static/documentation_options.js?v=2709fde1"></script>
      <script src="../../_static/doctools.js?v=9bcbadda"></script>
      <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="prev" title="Using DeepTune for Training" href="training.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../index.html" class="icon icon-home">
            DeepTune
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">User Guide</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../guides/install.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../guides/preface.html">Preface</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Functionalities</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="split.html">Handling Datasets</a></li>
<li class="toctree-l1"><a class="reference internal" href="training.html">Using <cite>DeepTune</cite> for Training</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Using <cite>DeepTune</cite> for Evaluation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#images">Images</a></li>
<li class="toctree-l2"><a class="reference internal" href="#text">Text</a></li>
<li class="toctree-l2"><a class="reference internal" href="#tabular">Tabular</a></li>
<li class="toctree-l2"><a class="reference internal" href="#evaluation-output">Evaluation Output</a></li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">DeepTune</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Using <cite>DeepTune</cite> for Evaluation</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../_sources/functionalities/handlers/evaluation.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="using-deeptune-for-evaluation">
<h1>Using <cite>DeepTune</cite> for Evaluation<a class="headerlink" href="#using-deeptune-for-evaluation" title="Link to this heading"></a></h1>
<section id="images">
<h2>Images<a class="headerlink" href="#images" title="Link to this heading"></a></h2>
<p>Evaluating your model on a separete holdout test dataset is referred to as evaluation. The reason is to simply not confuse the terms as testing in <cite>DeepTune</cite> documentation context also refers to testing the model functionality (e.g, writing test cases).</p>
<p>After using <cite>DeepTune</cite> to apply transfer learning on one of the models the package support, now we need to evaluate the performance of the tuned model for images.</p>
<p>The following is the generic CLI structure of running DeepTune for evalaution of image datasets:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>python<span class="w"> </span>-m<span class="w"> </span>evaluators.vision.evaluate<span class="w"> </span><span class="se">\</span>
--eval_df<span class="w"> </span>&lt;str&gt;<span class="w"> </span><span class="se">\</span>
--model_version<span class="w"> </span>&lt;str&gt;<span class="w"> </span><span class="se">\</span>
--batch_size<span class="w"> </span>&lt;int&gt;<span class="w"> </span><span class="se">\</span>
--num_classes<span class="w"> </span>&lt;int&gt;<span class="w"> </span><span class="se">\</span>
--model_weights<span class="w"> </span>&lt;str&gt;<span class="w"> </span><span class="se">\</span>
--added_layers<span class="w"> </span>&lt;int&gt;<span class="w"> </span><span class="se">\</span>
--embed_size<span class="w"> </span>&lt;int&gt;<span class="w"> </span><span class="se">\</span>
--mode<span class="w"> </span>&lt;cls_or_reg&gt;<span class="w"> </span><span class="se">\</span>
--out<span class="w"> </span>&lt;str&gt;<span class="w"> </span><span class="se">\</span>
<span class="o">[</span>--use-peft<span class="o">]</span><span class="w"> </span><span class="se">\</span>
<span class="o">[</span>--freeze-backbone<span class="o">]</span>
</pre></div>
</div>
<table class="docutils align-default">
<colgroup>
<col style="width: 25.0%" />
<col style="width: 75.0%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">--eval_df</span> <span class="pre">&lt;str&gt;</span></code></p></td>
<td><p>Path to your test dataset. It should be the <a href="#id1"><span class="problematic" id="id2">``</span></a>test_split_&lt;yyyymmdd&gt;_&lt;hhmm&gt;.parquet `` you got from the previous <cite>DeepTune</cite> for splitting data run.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">--model_weights</span> <span class="pre">&lt;str&gt;</span></code></p></td>
<td><p>Path to your model’s weights. It should be <code class="docutils literal notranslate"><span class="pre">`model_weights.pth</span></code> you got from the previous <cite>DeepTune</cite> for training run.</p></td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If you used one of the switches <code class="docutils literal notranslate"><span class="pre">--freeze_backone</span></code> or <code class="docutils literal notranslate"><span class="pre">--use_peft</span></code> or both in the previous run, you should use them while doing your evaluation here again. Also, you feed the evaluator here the same <code class="docutils literal notranslate"><span class="pre">--added_layers</span></code> and <code class="docutils literal notranslate"><span class="pre">--embed_size</span></code> you used for your previous training run of DeepTune. Otherwise, a mismatch error will occur.</p>
</div>
<p>If everything is set correctly, and evaluation is done, you should expect an output in the same format:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>&gt; Model into the path is loaded. 100%|█████████████████████████████████████████████████████| 107/107 [00:10&lt;00:00, 10.03it/s] 98.18713450292398 0.05557631243869067 INFO | Test accuracy: 98.18713450292398%
&gt; {&#39;loss&#39;: 0.05557631243869067, &#39;accuracy&#39;: 0.9818713450292398, &#39;0&#39;: {&#39;precision&#39;: 1.0, &#39;recall&#39;: 0.967479674796748, &#39;f1-score&#39;: 0.9834710743801653, &#39;support&#39;: 123.0},&#39;auroc&#39;: 0.9997672516861436}
&gt; Test results saved successfully!
</pre></div>
</div>
</section>
<section id="text">
<h2>Text<a class="headerlink" href="#text" title="Link to this heading"></a></h2>
<p>In <cite>DeepTune</cite>, the text SoTA models save the weights of both the models, and the tokenizers. The tokenizer role is to split sentences into smaller units (we call them tokens) that can be more easily assigned meaning. On the other hand, the model is responsible for handling the part of interpreting these tokens.</p>
<p>The generic CLI structure of running <em>DeepTune</em> for evalaution of text datasets:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>python<span class="w"> </span>-m<span class="w"> </span>evaluators.nlp.evaluate_&lt;multilingualbert/gpt&gt;<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>--eval_df<span class="w"> </span>&lt;str&gt;<span class="w"> </span><span class="se">\</span>
--batch_size<span class="w"> </span>&lt;int&gt;<span class="w"> </span><span class="se">\</span>
--num_classes<span class="w"> </span>&lt;int&gt;<span class="w"> </span><span class="se">\</span>
--model_weights<span class="w"> </span>&lt;str&gt;<span class="w"> </span><span class="se">\</span>
--added_layers<span class="w"> </span>&lt;int&gt;<span class="w"> </span><span class="se">\</span>
--embed_size<span class="w"> </span>&lt;int&gt;<span class="w"> </span><span class="se">\</span>
--out<span class="w"> </span>&lt;str&gt;<span class="w"> </span><span class="se">\</span>
<span class="o">[</span>--use-peft<span class="o">]</span><span class="w"> </span><span class="se">\</span>
<span class="o">[</span>--freeze-backbone<span class="o">]</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>For the <code class="docutils literal notranslate"><span class="pre">--model_weights</span></code> argument, we feed the whole output directory we got from running <cite>DeepTune</cite> for training (<code class="docutils literal notranslate"><span class="pre">trainval_output_&lt;BERT/GPT2&gt;_&lt;yyyymmdd_hhmm&gt;</span></code>)</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>For GPT-2 model, the switches <code class="docutils literal notranslate"><span class="pre">--added_layers</span></code> and <code class="docutils literal notranslate"><span class="pre">embed_size</span></code> are set by default as we tweaked the model architecture in order to be properly ready for training due to design constrains, so you don’t have to set these to a specific input.</p>
</div>
</section>
<section id="tabular">
<h2>Tabular<a class="headerlink" href="#tabular" title="Link to this heading"></a></h2>
<p>The generic CLI structure of running <em>DeepTune</em> for evalaution of text datasets using GANDALF is:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>python<span class="w"> </span>-m<span class="w"> </span>evaluators.tabular.evaluate_gandalf<span class="w"> </span><span class="se">\</span>
--eval_df<span class="w"> </span>&lt;str&gt;<span class="w"> </span><span class="se">\</span>
--model_weights<span class="w"> </span>&lt;str&gt;
<span class="go">--out &lt;str&gt;</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>You feed the path to <code class="docutils literal notranslate"><span class="pre">GANDALF_model</span></code> subdirectory that you obtained after training as a parameter to <code class="docutils literal notranslate"><span class="pre">--model_weights</span></code>.</p>
</div>
</section>
<section id="evaluation-output">
<h2>Evaluation Output<a class="headerlink" href="#evaluation-output" title="Link to this heading"></a></h2>
<p>After evaluation is done, you may find the results in the directory specified with the <code class="docutils literal notranslate"><span class="pre">--out</span></code> directory or <code class="docutils literal notranslate"><span class="pre">deeptune_results</span></code> initiated in your <cite>DeepTune</cite> path. Inside this folder, you will find the following output directory:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">output_directory</span>
<span class="go">├── eval_output_FINETUNED/PEFT-&lt;model_version&gt;_&lt;yyyymmdd&gt;_&lt;hhmm&gt;</span>
<span class="go">    └── cli_arguments.json</span>
<span class="go">    └── full_metrics.json</span>
<span class="go">    └── evaluation_details.json</span>
</pre></div>
</div>
<table class="docutils align-default">
<colgroup>
<col style="width: 25.0%" />
<col style="width: 75.0%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">cli_arguments.json</span></code></p></td>
<td><p>Records the CLI arguments you entered to run <code class="docutils literal notranslate"><span class="pre">DeepTune</span></code>.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">full_metrics.json</span></code></p></td>
<td><p>The full metrics as appeared to you in the CLI while using the model.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">evaluation_details.json</span></code></p></td>
<td><p>Stores the amount of time needed between starting and completing the training.</p></td>
</tr>
</tbody>
</table>
<p>Similarly, the output of the text and tabular datasets will have the same structure but with respectively different directory namings.</p>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="training.html" class="btn btn-neutral float-left" title="Using DeepTune for Training" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2025, Moayadeldin Hussain.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>